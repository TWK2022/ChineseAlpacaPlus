1,环境:linux
torch==1.12.0:https://pytorch.org/get-started/previous-versions/
pip install transformers sentencepiece -i https://pypi.doubanio.com/simple
pip install git+https://github.com/huggingface/peft

2,llama_to_hf.py:将llama_7b模型转为HuggingFace格式
(或者直接下载已经转好的llama_7b_hf模型:https://www.123pan.com/s/sKd9-bBJc.html)
下载facebook官方llama_7b模型，包含tokenizer.model、tokenizer_checklist.chk、consolidated.*.pth、params.json
将tokenizer.model放到input_dir中，其余文件放入input_dir/model_size中，转换后保存在output_dir
python llama_to_hf.py  --input_dir /TRAINING_CACHE/llama --model_size 7b --output_dir /TRAINING_CACHE/llama_7b_hf

3,下载chinese_alpaca_plus_lora_7b
百度网盘:https://pan.baidu.com/s/12tjjxmDWwLBM8Tj_7FAjHg?login_type=qzone&pwd=32hc&_at_=1683274834793
google网盘(外网):https://drive.google.com/uc?id=1EDcTmq6tDmRxqarpapdyDGBE9opY0zrB&export=download

4,merge_model.py:合并模型
python merge_model.py --base_model /TRAINING_CACHE/llama_7b_hf  --lora_model /TRAINING_CACHE/chinese_alpaca_plus_lora_7b  --output_type huggingface --output_dir chinese_alpaca_plus_7b

